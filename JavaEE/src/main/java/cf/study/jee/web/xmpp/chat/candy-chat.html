<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Xmpp.openfire-strophe.basic</title>
	<link href="/res/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
	<link href="/res/style.css" rel="stylesheet" />
	<script type="text/javascript" src="/res/jquery-2.1.1.js" ></script>
	<script type="text/javascript" src="/res/jquery.xslt.js"></script>
	<script type="text/javascript" src="/res/bootstrap/js/bootstrap.min.js"></script>	
	<script type="text/javascript" src="./candy/libs/libs.bundle.js" ></script>
	<script type="text/javascript" src="./candy/candy.bundle.js" ></script>
</head>
<body>
	<nav class="navbar navbar-default" role="navigation">
		<div class="navbar-header navbar-brand">
			Candy-Chat
		</div>
		<div id="login" class="nav navbar-right navbar-top-links">
			<form name="cred"  class="navbar-form">
			<div class="form-group">
				<label for="jid" class="sr-only">JID: </label>
				<input type="text" id="jid" placeholder="Enter JID" class="form-control" value="test1@cfcodefans"/>
				</div>
			<div class="form-group">
				<label for="pass" class="sr-only">Password: </label>
				<input type="password" id="pass" class="form-control" placeholder="Password" value="test1"/>
			</div>
				<div class="checkbox">
					<label> <input type="checkbox">Create User
					</label>
				</div>
				<input type="button" id="connect" value="connect" class="btn btn-primary"/>
			</form>
		</div>
	</nav>
	<div class="container row">
		<div id="chat_contacts" class="col-xs-3 left-sidebar">
			<div id="chat_rooms" class="panel panel-default">
				<div id="header" class="panel-header">
				</div>
				<div id="body" class="panel-body">
				</div>
			</div>
		</div>
		<div id="chat" class="col-xs-6">
		</div>
		<div id="log" class="col-xs-3">
			<ul class="list-group">
			
			</ul>
		</div>
	</div>
<!-- 	<div class="container row" id="candy"> -->
<!-- 	</div> -->
	<script type="text/javascript">
		var BOSH_SERVICE = "http://localhost/xmpp/httpbind/";
		
		var logUL = $("#log .list-group");	
		function log(msg) {
			logUL.append("<li class='list-group-item'>" + msg + "</li>");
		}
		function rawInput(data) { log('RECV: ' + data);	}
		function rawOutput(data) { log('SENT: ' + data); }
		
		function _handler() {
			
			var status = arguments[0];
			if (status == Strophe.Status.DISCONNECTED) {
				log("Strophe is disconnected.");
				$("#connect").val("connect");
			}
			console.info(arguments);
		}
		
		var conn;
		var candy;
		$(function() {
			Candy.init(BOSH_SERVICE, {
				core:{debug:true, autojoin: false},
				view: {assets: 'candy/res/'}
			});
			conn = Candy.Core.getConnection();
			candy = Candy.Core;
		});
		
		$("#connect").click(function() {
			if (this.value == "connect") {
				candy.connect($("#jid").val(), $("#pass").val(), $("#jid").val());
				candy.addHandler(_handler);
				this.value = "disconnect";
			} else {
				candy.disconnect();
			}
		});
		
	</script>
</body>
</html>